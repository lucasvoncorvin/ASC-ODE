
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Runge Kutta &#8212; ASC-ODE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'example_runge_kutta';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Autodiff" href="example_autodiff.html" />
    <link rel="prev" title="Electric Network" href="example_electric_network.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="ASC-ODE - Home"/>
    <script>document.write(`<img src="_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="ASC-ODE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Intro
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="solving_ODEs.html">Solving ODEs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="runge_kutta_timesteppers.html">General Runge Kutta</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="examples.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example_mass_spring.html">Mass-Spring System</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_electric_network.html">Electric Network</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Runge Kutta</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_autodiff.html">Autodiff</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="other_stuff.html">Useful Classes</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/lucasvoncorvin/ASC-ODE" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/example_runge_kutta.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Runge Kutta</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="runge-kutta">
<h1>Runge Kutta<a class="headerlink" href="#runge-kutta" title="Link to this heading">#</a></h1>
<p>In this section we will now investigate the implementation of 3 different Runge Kutta Schemes for the past problems as the Mass Spring and the Electric Circuit models.
In general, all the methods that were already discussed, as the Explicit/ Implicit Euler and also the improved Euler as well as the Crank Nicolson method, can be formulated as Runge Kutta methods.
They have convergence order 1 and 2. Therefore we aim to investigate higher order methods. In Runge Kutta methods, each time step is divided into an amount of stages m and therefore each time steps is resolved at a higher accuracy which depends on the number of stages. For convergence, there are different rules regarding the method. For explicit Runge Kutta schemes there exists the rule that the order of convergence <span class="math notranslate nohighlight">\(p leq m\)</span>. However for <span class="math notranslate nohighlight">\(m \beq 5\)</span> it has not been possible to recover <span class="math notranslate nohighlight">\(p=m\)</span>. Therefore, a very popular method is the Runge Kutta 4 Explicit which has order 4 convergence.
In general the order of convergence is equivalent to the order of accuracy of the numerical integration. Therefore, for implicit methods, it becomes clear, that choosing Gauss integration methods will leas to the highest convergence rates of order <span class="math notranslate nohighlight">\(p=2m\)</span>.
For implcit RK methods the rule is <span class="math notranslate nohighlight">\(p \leq 2m\)</span>. Another popular method is the Radau method, which has oder <span class="math notranslate nohighlight">\(p = 2m-1\)</span>, where the last coefficient <span class="math notranslate nohighlight">\(c_m =1\)</span> is fixed.
Therefore we chose to investigate the following three methods:</p>
<ul class="simple">
<li><p>Runge Kutta 4 Explicit - p = 4</p></li>
<li><p>Gauss Method m = 4     - p = 8</p></li>
<li><p>Radau Method m = 4     - p = 7</p></li>
</ul>
<p>We expect accurate solutions for larger time steps already, as well as for the stiff problem, we expect exploding solutions for the explicit method.</p>
<p>Mass Spring Model</p>
<p>40 time steps</p>
<a class="reference internal image-reference" href="_images/time_evolution_position_40.png"><img alt="_images/time_evolution_position_40.png" src="_images/time_evolution_position_40.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_40.png"><img alt="_images/phase_plot_40.png" src="_images/phase_plot_40.png" style="width: 45%;" />
</a>
<p>20 time steps</p>
<a class="reference internal image-reference" href="_images/time_evolution_position_20.png"><img alt="_images/time_evolution_position_20.png" src="_images/time_evolution_position_20.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_201.png"><img alt="_images/phase_plot_201.png" src="_images/phase_plot_201.png" style="width: 45%;" />
</a>
<p>10 time steps</p>
<a class="reference internal image-reference" href="_images/time_evolution_position_10.png"><img alt="_images/time_evolution_position_10.png" src="_images/time_evolution_position_10.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_10.png"><img alt="_images/phase_plot_10.png" src="_images/phase_plot_10.png" style="width: 45%;" />
</a>
<p>As expected, we see already for very large time scales, that the oscillations of the system are represented quite well and for N = 40, we already get perfect circles for the phase plot.
This is due to higher convergence rates. For the largest time step, we can also see difference in the lower order method of the Explicit method, that shows less accurate behavior.</p>
<p>Now we look at the Electric Circuit model. Again we start by choosing <span class="math notranslate nohighlight">\(R=C=1\)</span> and we expect similar behavior to the one observed by the implicit Euler, where the transient solution will disappear after a few seconds.</p>
<p>200 time steps</p>
<a class="reference internal image-reference" href="_images/UC_time_evolution_1_200.png"><img alt="_images/UC_time_evolution_1_200.png" src="_images/UC_time_evolution_1_200.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_U_dU_1_200.png"><img alt="_images/phase_plot_U_dU_1_200.png" src="_images/phase_plot_U_dU_1_200.png" style="width: 45%;" />
</a>
<p>500 time steps</p>
<a class="reference internal image-reference" href="_images/UC_time_evolution_1_500.png"><img alt="_images/UC_time_evolution_1_500.png" src="_images/UC_time_evolution_1_500.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_U_dU_1_500.png"><img alt="_images/phase_plot_U_dU_1_500.png" src="_images/phase_plot_U_dU_1_500.png" style="width: 45%;" />
</a>
<p>We see, for the larger time step, the exponential decay is not visible and the RK4 method gives higher amplitudes. For smaller time steps, we see already accurate solutions as the exponential decay is visible.</p>
<p>Now we will look at the stiff Problem. Again we expect exploding solutions for the RK4.</p>
<p>1000 time steps</p>
<a class="reference internal image-reference" href="_images/UC_time_evolution_stiff_1000.png"><img alt="_images/UC_time_evolution_stiff_1000.png" src="_images/UC_time_evolution_stiff_1000.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_U_dU_stiff_1000.png"><img alt="_images/phase_plot_U_dU_stiff_1000.png" src="_images/phase_plot_U_dU_stiff_1000.png" style="width: 45%;" />
</a>
<p>1000 time steps</p>
<a class="reference internal image-reference" href="_images/UC_time_evolution_stiff_1000_NORK4.png"><img alt="_images/UC_time_evolution_stiff_1000_NORK4.png" src="_images/UC_time_evolution_stiff_1000_NORK4.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_U_dU_stiff_1000_NORK4.png"><img alt="_images/phase_plot_U_dU_stiff_1000_NORK4.png" src="_images/phase_plot_U_dU_stiff_1000_NORK4.png" style="width: 45%;" />
</a>
<p>200 time steps</p>
<a class="reference internal image-reference" href="_images/UC_time_evolution_stiff_200.png"><img alt="_images/UC_time_evolution_stiff_200.png" src="_images/UC_time_evolution_stiff_200.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="_images/phase_plot_U_dU_stiff_200.png"><img alt="_images/phase_plot_U_dU_stiff_200.png" src="_images/phase_plot_U_dU_stiff_200.png" style="width: 45%;" />
</a>
<p>We observe exploding results of the explicit method and accurate results for the implicit methods already for larger time steps. For N = 1000, we see very accurate behavior.
To conclude, we can say, that choosing higher order Runge Kutta Methods is recommended due to its higher convergence rates. For non stiff problems and a sufficient time step, the RK4 gives already very accurate solutions and might be preferred due to its lower computational costs compared to the implicit methods. However, for stiff problems, one should always choose an implicit method due to stability.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_electric_network.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Electric Network</p>
      </div>
    </a>
    <a class="right-next"
       href="example_autodiff.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Autodiff</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Team 03
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>